<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ニトロペン（舌下投与）Audio Guide</title>
<style>
  body { font-family: -apple-system, BlinkMacSystemFont, "Hiragino Sans", "Segoe UI", sans-serif; margin: 18px; line-height: 1.6; }
  h1 { margin: 0 0 6px; font-size: 22px; }
  .sub { margin: 0 0 14px; color: #555; font-size: 14px; }
  .panel { border: 1px solid #ddd; border-radius: 14px; padding: 14px; background: #fafafa; max-width: 820px; }
  .row { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }
  select { font-size: 16px; padding: 10px 12px; border-radius: 12px; border: 1px solid #ccc; background: #fff; min-width: 240px; }
  button { font-size: 18px; padding: 12px 16px; border-radius: 12px; border: 1px solid #ccc; background: #fff; }
  .label { font-size: 12px; color:#666; margin: 12px 0 6px; }
  .jp { font-size: 18px; font-weight: 700; margin: 0; }
  .en { margin: 8px 0 0; font-size: 16px; }
  .status { margin-top: 10px; color:#444; }
  .note { font-size: 12px; color:#666; margin-top: 10px; }
  .badge { display:inline-block; font-size:12px; padding: 2px 8px; border-radius: 999px; border:1px solid #ddd; background:#fff; color:#444; }
</style>
</head>
<body>
  <h1>ニトロペン（舌下投与）音声ガイド</h1>
  <p class="sub">1枚のQRから開くページ想定（iPhoneの自動再生制限のため、ボタンで再生します）。</p>

  <div class="panel">
    <div class="row">
      <span class="badge">ステップ選択</span>
      <select id="sel"></select>
      <button id="prev">← 前</button>
      <button id="next">次 →</button>
    </div>

    <div class="label">日本語（内容）</div>
    <p class="jp" id="jp"></p>

    <div class="label">English (Script)</div>
    <p class="en" id="en"></p>

    <div class="row" style="margin-top:12px;">
      <button id="play">▶︎ 再生 / Play</button>
      <button id="pause">⏸ 一時停止 / Pause</button>
      <button id="replay">↻ もう一度 / Replay</button>
    </div>

    <div class="status" id="status">待機中 / Ready</div>

    <audio id="audio" preload="auto"></audio>

    <div class="note">
      ※ 画面を見せながら「選択 → 再生」でも使えます。<br>
      Tip: You can tap Next/Prev and Play quickly during the procedure.
    </div>
  </div>

<script>
const DATA = [{"id": 1, "jp": "これからニトロペン（ニトログリセリン）を舌の下に入れます。心臓の血管を広げる薬です。", "en": "We're going to put a medicine under your tongue. It helps widen the blood vessels in your heart.", "src": "audio/nitro01.m4a"}, {"id": 2, "jp": "これは舌下錠です。舌の下で溶けるので、飲み込まないでください。", "en": "This is a sublingual tablet that dissolves under your tongue, so please don't swallow it.", "src": "audio/nitro02.m4a"}, {"id": 3, "jp": "溶けにくい場合は、舌を少し動かしても大丈夫です。噛んだり、かみ砕いたりしないでください。", "en": "If it's hard to dissolve, you can lick it like a candy to help it dissolved, but please don't chew or bite it.", "src": "audio/nitro03.m4a"}, {"id": 4, "jp": "この薬は血管を広げます。軽い頭痛を感じる方がいますが、心配いりません。", "en": "This medicine can also widen the blood vessels in your brain, so you may feel a light headache, but it's nothing to worry about.", "src": "audio/nitro04.m4a"}, {"id": 5, "jp": "多くの方は軽い頭痛程度です。もし頭痛が強くなったら、すぐに教えてください。", "en": "Most patients feel just a mild headache, but if you feel the headache is getting worse, please tell us right away.", "src": "audio/nitro05.m4a"}, {"id": 6, "jp": "今からマスクを少し下げます。", "en": "Let me lower your mask now.", "src": "audio/nitro06.m4a"}, {"id": 7, "jp": "口を開けて、舌を上げてください。", "en": "Please open your mouth and lift your tongue.", "src": "audio/nitro07.m4a"}, {"id": 8, "jp": "錠剤を飲み込まないでください。", "en": "Please don't swallow the tablet.", "src": "audio/nitro08.m4a"}, {"id": 9, "jp": "飴のように、舌の上で溶かしてください。", "en": "Let it dissolve like a candy on your tongue.", "src": "audio/nitro09.m4a"}, {"id": 10, "jp": "薬が溶けたら教えてください。", "en": "Please let me know when the medicine has dissolved.", "src": "audio/nitro10.m4a"}, {"id": 11, "jp": "溶けましたか？まだ舌の下に残っていますか？", "en": "Has it dissolved? Is it still there under your tongue?", "src": "audio/nitro11.m4a"}];
const sel = document.getElementById('sel');
const jp = document.getElementById('jp');
const en = document.getElementById('en');
const audio = document.getElementById('audio');
const status = document.getElementById('status');

const playBtn = document.getElementById('play');
const pauseBtn = document.getElementById('pause');
const replayBtn = document.getElementById('replay');
const prevBtn = document.getElementById('prev');
const nextBtn = document.getElementById('next');

DATA.forEach((item) => {
  const opt = document.createElement('option');
  opt.value = item.id;
  opt.textContent = String(item.id).padStart(2,'0') + ". " + item.jp;
  sel.appendChild(opt);
});

function load(id) {
  const item = DATA.find(x => x.id === Number(id));
  jp.textContent = item.jp;
  en.textContent = item.en;
  audio.src = item.src;
  status.textContent = "待機中 / Ready";
  sel.value = String(item.id);
}

sel.addEventListener('change', e => load(e.target.value));

playBtn.addEventListener('click', async () => {
  try {
    await audio.play();
    status.textContent = "再生中 / Playing";
  } catch (e) {
    status.textContent = "再生できませんでした / Couldn't play";
  }
});

pauseBtn.addEventListener('click', () => {
  audio.pause();
  status.textContent = "一時停止 / Paused";
});

replayBtn.addEventListener('click', async () => {
  try {
    audio.currentTime = 0;
    await audio.play();
    status.textContent = "再生中 / Playing";
  } catch (e) {
    status.textContent = "再生できませんでした / Couldn't play";
  }
});

prevBtn.addEventListener('click', () => {
  const cur = Number(sel.value);
  const next = Math.max(1, cur - 1);
  load(next);
});

nextBtn.addEventListener('click', () => {
  const cur = Number(sel.value);
  const next = Math.min(DATA.length, cur + 1);
  load(next);
});

audio.addEventListener('ended', () => {
  status.textContent = "再生終了 / Finished";
});

load(1);
</script>
</body>
</html>
